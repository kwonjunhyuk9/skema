# ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

## **1. ì‹œìŠ¤í…œ ê°œìš”**

SkemaëŠ” ê°œë… êµ¬ì¡°ì™€ í•™ìŠµ ë‚´ìš©ì„ ì‹œê°í™”í•˜ê³  ë°˜ë³µ í•™ìŠµí•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ëŠ” í•™ìŠµ ë„êµ¬ì´ë‹¤. ì‚¬ìš©ìëŠ” ë‹¤ì´ì–´ê·¸ë¨ ê¸°ë°˜ìœ¼ë¡œ ê°œë…ì„ ì •ë¦¬í•˜ê³ , ì–´íœ˜ ì¹´ë“œì™€ ë³µìŠµ íë¦„ì„ í†µí•´ í•™ìŠµì„ ì§„í–‰í•œë‹¤. ì‹œìŠ¤í…œì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ API ì¤‘ì‹¬ êµ¬ì¡°ë¡œ êµ¬ì„±ë˜ë©°, ì¸ì¦, ë°ì´í„° ê´€ë¦¬, ì•Œë¦¼ ì²˜ë¦¬ë¥¼ ëª…í™•íˆ ë¶„ë¦¬í•˜ì—¬ í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ ê³ ë ¤í•´ ì„¤ê³„ë˜ì—ˆë‹¤.

---

## **2. ê¸°ìˆ  ìŠ¤íƒ**

SkemaëŠ” í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œë¥¼ TypeScript ê¸°ë°˜ìœ¼ë¡œ í†µì¼í•˜ì—¬ ê°œë°œ ìƒì‚°ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ ë†’ì˜€ë‹¤. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì»´í¬ë„ŒíŠ¸ ì¤‘ì‹¬ì˜ UIì™€ ì„œë²„ ë Œë”ë§ì„ ê³ ë ¤í•´ êµ¬ì„±ë˜ì—ˆìœ¼ë©°, ì„œë²„ëŠ” API ì¤‘ì‹¬ êµ¬ì¡°ë¡œ ì„¤ê³„ë˜ì—ˆë‹¤. ë°°í¬ì™€ ìš´ì˜ì€ í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ìë™í™”ëœ íŒŒì´í”„ë¼ì¸ì„ í†µí•´ ê´€ë¦¬ëœë‹¤.

| êµ¬ì„± ìš”ì†Œ | ì‚¬ìš© ê¸°ìˆ  |
| --- | --- |
| í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ | TypeScript, React, Next, HTML, CSS |
| ë°±ì—”ë“œ ê°œë°œ | TypeScript, Node, Nest, PostgreSQL |
| ë²„ì „ ê´€ë¦¬ | Unix, Git, GitHub |
| ë°°í¬ ë° ì¸í”„ë¼ | AWS ECS, AWS RDS |
| ì½”ë“œ í’ˆì§ˆ ê´€ë¦¬ | Prettier, ESLint, StyleLint |
| í…ŒìŠ¤íŠ¸ | Jest, Playwright |
| API ëª…ì„¸ | OpenAPI |
| CI/CD | Github Actions, Docker |

---

## **3. ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨**

### 3.1 ì»¨í…ìŠ¤íŠ¸ ë‹¤ì´ì–´ê·¸ë¨

ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ Skemaì™€ ì‚¬ìš©ì, ìš´ì˜ì, ì™¸ë¶€ ì‹œìŠ¤í…œ ê°„ì˜ ìƒí˜¸ì‘ìš© ë²”ìœ„ë¥¼ ë³´ì—¬ì¤€ë‹¤. ì‚¬ìš©ìëŠ” Skemaë¥¼ í†µí•´ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ë©°, ìš´ì˜ìëŠ” ê°œë°œê³¼ ë°°í¬ë¥¼ ë‹´ë‹¹í•œë‹¤. SkemaëŠ” í´ë¼ìš°ë“œ ì¸í”„ë¼ ìœ„ì—ì„œ ì‹¤í–‰ë˜ê³ , ì¸ì¦ê³¼ ë°°í¬ëŠ” ì™¸ë¶€ ì‹œìŠ¤í…œì— ì˜ì¡´í•œë‹¤.

```mermaid
flowchart LR
  subgraph Actor
    User["ğŸ‘¤ User<br/>Uses the Skema service<br/>(Actor)"]
    Engineer["ğŸ§‘â€ğŸ’» Engineer<br/>Develops and maintains Skema<br/>(Actor)"]
  end

  subgraph Internal
    Skema["ğŸ§  Skema<br/>Core application providing the service<br/>(Internal System)"]
  end
  
  subgraph External
    AWS["â˜ï¸ AWS<br/>Cloud infrastructure hosting the system<br/>(External System)"]
    GitHub["ğŸ™ GitHub<br/>Source control and CI/CD pipeline<br/>(External System)"]
    OAuth["ğŸ” OAuth<br/>User authentication provider<br/>(External System)"]
    
    GitHub -->|Deploys| AWS
  end

  User -->|Uses| Skema
  Engineer -->|Develops| Skema

  Skema -->|Runs on| AWS
  Skema -->|Authenticates| OAuth
  Skema -->|Publishes| GitHub 
```

### 3.2 ì»¨í…Œì´ë„ˆ ë‹¤ì´ì–´ê·¸ë¨

ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ Skemaë¥¼ êµ¬ì„±í•˜ëŠ” ì£¼ìš” ì‹¤í–‰ ë‹¨ìœ„ì™€ ê·¸ ì±…ì„ ë¶„ë¦¬ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤, API ì²˜ë¦¬, ì•Œë¦¼ ì²˜ë¦¬ëŠ” ê°ê° ë…ë¦½ëœ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬ë˜ì–´ ë°°í¬ëœë‹¤. í•µì‹¬ ë°ì´í„°ëŠ” ì¤‘ì•™ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ë©°, ë¹„ë™ê¸° ì´ë²¤íŠ¸ëŠ” ë©”ì‹œì§€ íë¥¼ í†µí•´ ì²˜ë¦¬ëœë‹¤.

```mermaid
flowchart LR
  subgraph Actor
    User["ğŸ‘¤ User<br/>Uses the Skema service<br/>(Actor)"]
    Engineer["ğŸ§‘â€ğŸ’» Engineer<br/>Develops and maintains Skema<br/>(Actor)"]
  end
  
  subgraph Skema
    Web["ğŸŒ Web App<br/>User Interface<br/>(Next)"]
    Mermaid["ğŸ§© Mermaid Renderer<br/>Client-side realtime rendering of diagrams<br/>(Mermaid)"]
    API["âš™ï¸ API Service<br/>Business logic and REST API<br/>(Nest)"]
    Notification["ğŸ”” Notification Worker<br/>Email and Push notifications<br/>(Nest Worker)"]
    DB[("ğŸ—„ï¸ Database<br/>Stores application data<br/>(PostgreSQL)")]

    Web -->|HTTPS| API
    API -->|TCP| DB

    Web -->|Render diagrams| Mermaid
    Mermaid -->|Display diagrams| Web
  end
  
  subgraph OAuth
    Apple["â¬œï¸ Apple<br/>OAuth identity provider<br/>(External System)"]
    Google["ğŸŸ¦ Google<br/>OAuth identity provider<br/>(External System)"]
    Naver["ğŸŸ© Naver<br/>OAuth identity provider<br/>(External System)"]
    Kakao["ğŸŸ¨ Kakao<br/>OAuth identity provider<br/>(External System)"]
  end
  
  subgraph GitHub
    Repo["ğŸ“ Repository<br/>Stores source code<br/>(GitHub Repository)"]
    CICD["ğŸ”„ CI/CD Pipeline<br/>Builds and deploys artifacts<br/>(GitHub Actions)"]
    
    Repo -->|Triggers| CICD
  end
  
  subgraph AWS
    ECS["ğŸ“¦ ECS<br/>Runs application containers<br/>(AWS ECS)"]
    RDS["ğŸ—„ï¸ RDS<br/>Managed PostgreSQL database<br/>(AWS RDS)"]
    SQS["ğŸ“¨ SQS<br/>Message Queue<br/>(AWS SQS)"]
  end
  
  User -->|Uses| Web
  Engineer -->|Pushes| Repo
  
  API -->|OAuth| Apple
  API -->|OAuth| Google
  API -->|OAuth| Naver
  API -->|OAuth| Kakao

  API -->|Enqueue events| SQS
  Notification -->|Dequeue messages| SQS

  Web -->|Runs on| ECS
  API -->|Runs on| ECS
  Notification -->|Runs on| ECS
  DB -->|Runs on| RDS

  CICD -->|Deploys| ECS
  CICD -->|Migrates| RDS

```

### 3.3 Web App ì»´í¬ë„ŒíŠ¸ ë‹¤ì´ì–´ê·¸ë¨

ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ì˜ ì£¼ìš” ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ êµ¬ì„± ìš”ì†Œì™€ API ì—°ë™ êµ¬ì¡°ë¥¼ ë³´ì—¬ì¤€ë‹¤. ê° UI ì»´í¬ë„ŒíŠ¸ëŠ” ì‚¬ìš©ì ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ ë¶„ë¦¬ë˜ì–´ ìˆìœ¼ë©°, ê³µí†µ API í´ë¼ì´ì–¸íŠ¸ë¥¼ í†µí•´ ì„œë²„ì™€ í†µì‹ í•œë‹¤. ì•Œë¦¼ê³¼ ìƒíƒœ ë³€í™”ëŠ” UI ì „ë°˜ì— ê³µìœ ëœë‹¤.

```mermaid
flowchart LR
  subgraph Web App
    AuthUI["ğŸ” Authentication UI<br/>Login, logout, session handling<br/>(OAuth, Session)"]
    DiagramUI["ğŸ—ºï¸ Diagram Viewer and Editor<br/>Edit, zoom, version, preview diagrams<br/>(Mermaid)"]
    VocabUI["ğŸƒ Vocabulary Learning UI<br/>Card based learn and test flows<br/>(SPA State)"]
    Dash["ğŸ“Š Progress Dashboard<br/>Learning progress and review metrics<br/>(Charts)"]
    Browse["ğŸ” Content Search UI<br/>Keyword search and filtering<br/>(Search UX)"]
    NotiUI["ğŸ”” Notification UI<br/>Learning completion and review reminders<br/>(In app Alerts)"]
    SettingsUI["âš™ï¸ Settings UI<br/>Profile, theme, language settings<br/>(Preferences)"]

    APIClient["ğŸ“¡ API Client Layer<br/>Request handling, normalization, retries<br/>(REST Client)"]
  end

  AuthUI -->|auth requests| APIClient
  DiagramUI -->|diagram data| APIClient
  VocabUI -->|learning state| APIClient
  Dash -->|progress data| APIClient
  Browse -->|search queries| APIClient
  SettingsUI -->|user config| APIClient

  APIClient -->|deliver notifications| NotiUI

```

### 3.4 Mermaid Renderer ì»´í¬ë„ŒíŠ¸ ë‹¤ì´ì–´ê·¸ë¨

ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ ë‹¤ì´ì–´ê·¸ë¨ í…ìŠ¤íŠ¸ê°€ ì‹œê°ì  ê²°ê³¼ë¡œ ë³€í™˜ë˜ëŠ” ë‚´ë¶€ ì²˜ë¦¬ íë¦„ì„ ë‚˜íƒ€ë‚¸ë‹¤. ì…ë ¥ëœ í…ìŠ¤íŠ¸ëŠ” ê²€ì¦ê³¼ ë³´ì•ˆ ì²˜ë¦¬ë¥¼ ê±°ì³ ë Œë”ë§ë˜ë©°, ì„¤ì •ì— ë”°ë¼ ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°ì™€ ë‚´ë³´ë‚´ê¸°ê°€ ìˆ˜í–‰ëœë‹¤. ì˜¤ë¥˜ëŠ” ì¦‰ì‹œ ì‚¬ìš©ìì—ê²Œ í”¼ë“œë°±ëœë‹¤.

```mermaid
flowchart LR
  subgraph Mermaid Renderer
    Input["ğŸ“ Mermaid Text Input<br/>Diagram source text entry<br/>(Plain Text)"]
    Wrapper["âš™ï¸ Parsing and Rendering Wrapper<br/>Text to AST to SVG or Canvas<br/>(Mermaid Core)"]
    Config["ğŸ›ï¸ Render Configuration Manager<br/>Theme, direction, font, spacing<br/>(Render Options)"]
    Preview["â±ï¸ Real time Preview Controller<br/>Debounce, throttle, re render<br/>(UI Control)"]
    Error["ğŸ§¯ Error Detection and Handling<br/>Syntax and render errors<br/>(Validation)"]
    Export["ğŸ“¤ Export Module<br/>Diagram file export<br/>(SVG, PNG)"]
    Sandbox["ğŸ›¡ï¸ Sandbox and Security Config<br/>Block unsafe HTML, links, scripts<br/>(Security Policy)"]
    Output["ğŸ–¼ï¸ Rendered Diagram Output<br/>Final visual diagram<br/>(SVG or Canvas)"]
  end

  Input -->|text change| Preview
  Preview -->|controlled render| Sandbox
  Sandbox -->|safe input| Config
  Config -->|render options| Wrapper
  Wrapper -->|draw diagram| Output

  Wrapper -->|report errors| Error
  Error -->|feedback loop| Preview

  Output -->|export source| Export
  Config -->|export options| Export

```

### 3.5 Notification Service ì»´í¬ë„ŒíŠ¸ ë‹¤ì´ì–´ê·¸ë¨

ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ ì•Œë¦¼ ì´ë²¤íŠ¸ê°€ ì²˜ë¦¬ë˜ê³  ì „ë‹¬ë˜ëŠ” íë¦„ì„ ë³´ì—¬ì¤€ë‹¤. íì—ì„œ ìˆ˜ì‹ í•œ ì´ë²¤íŠ¸ëŠ” ìœ í˜•ì— ë”°ë¼ ë¶„ê¸°ë˜ë©°, í…œí”Œë¦¿ì„ í†µí•´ ë©”ì‹œì§€ê°€ ìƒì„±ëœë‹¤. ì „ì†¡ ê²°ê³¼ëŠ” ê¸°ë¡ë˜ê³ , ì‹¤íŒ¨í•œ ê²½ìš° ì¬ì‹œë„ ì •ì±…ì— ë”°ë¼ ë‹¤ì‹œ ì²˜ë¦¬ëœë‹¤.

```mermaid
flowchart LR
  subgraph Notification Service
    Consumer["ğŸ“¥ Queue Consumer<br/>Poll and dequeue messages<br/>(AWS SQS)"]
    Dispatcher["ğŸ§­ Notification Dispatcher<br/>Route messages by channel<br/>(Routing Logic)"]
    Template["ğŸ§© Template Rendering Engine<br/>Generate notification content<br/>(Template Engine)"]
    Provider["ğŸ”Œ Provider Integration Layer<br/>Send email and push messages<br/>(Email and Push Adapters)"]
    Retry["â™»ï¸ Retry and Failure Handling<br/>Retry rules and DLQ policy<br/>(Backoff Strategy)"]
    Log["ğŸ§¾ Notification Logging<br/>Track attempts and outcomes<br/>(Structured Logs)"]
  end

  Consumer -->|consume event| Dispatcher
  Dispatcher -->|select template| Template
  Template -->|render content| Provider

  Provider -->|send result| Log
  Consumer -->|receive record| Log
  Dispatcher -->|route record| Log

  Provider -->|failure| Retry
  Retry -->|requeue message| Consumer
  Retry -->|retry record| Log

```

### 3.6 API Service ì»´í¬ë„ŒíŠ¸ ë‹¤ì´ì–´ê·¸ë¨

ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ API ì„œë¹„ìŠ¤ ë‚´ë¶€ì˜ ë„ë©”ì¸ë³„ ì±…ì„ ë¶„ë¦¬ì™€ ì²˜ë¦¬ íë¦„ì„ ë‚˜íƒ€ë‚¸ë‹¤. ìš”ì²­ì€ ì¸ì¦ê³¼ ê²€ì¦ì„ ê±°ì³ ê° ë„ë©”ì¸ ë¡œì§ìœ¼ë¡œ ì „ë‹¬ëœë‹¤. ë°ì´í„°ëŠ” ì˜ì† ê³„ì¸µì„ í†µí•´ ê´€ë¦¬ë˜ë©°, í•™ìŠµ ì§„í–‰ê³¼ ë³µìŠµê³¼ ê´€ë ¨ëœ ì´ë²¤íŠ¸ëŠ” ì™¸ë¶€ ì•Œë¦¼ ì‹œìŠ¤í…œìœ¼ë¡œ ë°œí–‰ëœë‹¤.

```mermaid
flowchart LR
  subgraph API Service
    Auth["ğŸ” Authentication and Authorization Module<br/>OAuth login, JWT or session, role control<br/>(OAuth, JWT, RBAC)"]
    Concept["ğŸ§  Concept Structure Processing Module<br/>Validate, analyze, generate structures<br/>(Domain Logic)"]
    Vocab["ğŸƒ Vocabulary Management Module<br/>Create, update, dedupe, validate terms<br/>(CRUD Logic)"]
    Progress["ğŸ“ˆ Learning Progress Tracking Module<br/>Track activity and progress state<br/>(Progress Logic)"]
    Review["ğŸ” Review Scheduling Module<br/>Spaced repetition and review timing<br/>(Review Logic)"]
    Search["ğŸ” Search and Filtering Module<br/>Query and filter learning content<br/>(Search Logic)"]
    NotiPub["ğŸ“¨ Notification Event Publisher<br/>Emit events to message queue<br/>(AWS SQS)"] 
    User["ğŸ‘¤ User Management Module<br/>Profile and preference management<br/>(User Domain)"]
    
    APILayer["ğŸ§± API Layer<br/>Request routing and DTO validation<br/>(REST Controllers)"]
    Persist["ğŸ—„ï¸ Persistence Layer<br/>Data access and ORM mapping<br/>(ORM Repositories)"]
    LogErr["ğŸ§¾ Error Handling and Logging<br/>Exception handling and audit logs<br/>(Logging System)"]
  end

  APILayer -->|authenticate| Auth
  APILayer -->|user requests| User
  APILayer -->|concept ops| Concept
  APILayer -->|vocab ops| Vocab
  APILayer -->|progress ops| Progress
  APILayer -->|review ops| Review
  APILayer -->|search queries| Search

  Auth -->|store data| Persist
  User -->|store data| Persist
  Concept -->|store data| Persist
  Vocab -->|store data| Persist
  Progress -->|store data| Persist
  Review -->|store data| Persist
  Search -->|read data| Persist

  Progress -->|publish event| NotiPub
  Review -->|publish event| NotiPub

  APILayer -->|log error| LogErr
  Auth -->|log error| LogErr
  User -->|log error| LogErr
  Concept -->|log error| LogErr
  Vocab -->|log error| LogErr
  Progress -->|log error| LogErr
  Review -->|log error| LogErr
  Search -->|log error| LogErr
  NotiPub -->|log error| LogErr

```

### 3.7 Database ì»´í¬ë„ŒíŠ¸ ë‹¤ì´ì–´ê·¸ë¨

ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ëŠ” ì£¼ìš” ë°ì´í„° ì˜ì—­ê³¼ ê·¸ êµ¬ì¡°ë¥¼ ë³´ì—¬ì¤€ë‹¤. ì‚¬ìš©ì, í•™ìŠµ ì½˜í…ì¸ , í™œë™ ê¸°ë¡, ì•Œë¦¼ ì •ë³´ëŠ” ëª©ì ì— ë”°ë¼ ë¶„ë¦¬ëœ í…Œì´ë¸”ë¡œ ê´€ë¦¬ëœë‹¤. ì¸ë±ìŠ¤ì™€ ë§ˆì´ê·¸ë ˆì´ì…˜ êµ¬ì¡°ë¥¼ í†µí•´ ë¬´ê²°ì„±ê³¼ í™•ì¥ì„±ì„ ìœ ì§€í•œë‹¤.

```mermaid
flowchart LR
  subgraph Database
    Users[("ğŸ‘¤ User Tables<br/>Accounts, identities, roles, preferences<br/>(Relational Tables)")]
    Concepts[("ğŸ§  Concept Structure Tables<br/>Topics, nodes, edges, versions<br/>(Graph like Schema)")]
    Vocab[("ğŸƒ Vocabulary and Card Tables<br/>Words, definitions, card states<br/>(Learning Data)")]
    Activity[("ğŸ“ˆ Learning Activity Tables<br/>Sessions, progress, review history<br/>(Time Series Data)")]
    Index["âš¡ Indexes and Constraints<br/>Uniqueness and search optimization<br/>(DB Indexes)"]    
    Noti[("ğŸ”” Notification Tables<br/>Notification records and delivery status<br/>(Event Records)")]
    Settings[("âš™ï¸ Application Settings Tables<br/>System and feature configuration<br/>(Key Value Data)")]

    Audit[("ğŸ§¾ Audit and Log Tables<br/>Critical changes and error references<br/>(Audit Logs)")]
    Mig["ğŸ§° Migration and Versioning Support<br/>Schema evolution and rollback<br/>(Migration Tooling)"]
  end

  Users -->|apply rules| Index
  Concepts -->|apply rules| Index
  Vocab -->|apply rules| Index
  Activity -->|apply rules| Index
  Noti -->|apply rules| Index
  Settings -->|apply rules| Index
  Audit -->|apply rules| Index

  Mig -->|migrate| Users
  Mig -->|migrate| Concepts
  Mig -->|migrate| Vocab
  Mig -->|migrate| Activity
  Mig -->|migrate| Noti
  Mig -->|migrate| Settings
  Mig -->|migrate| Audit

```